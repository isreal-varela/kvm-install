# Generated by pykickstart v3.32
#version=ROCKY9
# Use text install
text --non-interactive

# Once install is finished, shut down
shutdown

eula --agreed

%addon com_redhat_kdump --disable

%end

# Keyboard layouts
keyboard --xlayouts='us'
# System language
lang en_US.UTF-8

# Network information
network  --bootproto=dhcp --device=enp1s0 --noipv6 --activate
network  --hostname=localhost.localdomain

# Configure firewall settings for the system (optional)
# --enabled	reject incoming connections that are not in response to outbound requests
# --ssh		allow sshd service through the firewall
firewall --enabled --ssh

# State of SELinux on the installed system (optional)
# Defaults to enforcing
selinux --enforcing

%packages
@^minimal-environment
cloud-init
vim 
tmux
qemu-guest-agent
lsof
aide
bash-completion
yum-utils
tar
unzip
postfix
cloud-utils-growpart
clevis.x86_64 
clevis-dracut.x86_64
clevis-luks.x86_64 
clevis-pin-tpm2.x86_64
clevis-systemd.x86_64
clevis-udisks2.x86_64 
ipa-client
iproute
gnutls-utils
rng-tools
rsyslog
rsync
audispd-plugins
subscription-manager
-iw*-firmware

%end

# Disable the Setup Agent on first boot
firstboot --disable

ignoredisk --only-use=vda

# Specify how the bootloader should be installed (required)
# Refer to e.g.
#   grub2-mkpasswd-pbkdf2
# to see how to create encrypted password form for different plaintext password
bootloader --location=mbr --boot-drive=vda --append="fips=1 audit=1 audit_backlog_limit=8192 slub_debug=P page_poison=1 vsyscall=none" --password=grub.pbkdf2.sha512.10000.45912D32B964BA58B91EAF9847F3CCE6F4C962638922543AFFAEE4D29951757F4336C181E6FC9030E07B7D9874DAD696A1B18978D995B1D7F27AF9C38159FDF3.99F65F3896012A0A3D571A99D6E6C695F3C51BE5343A01C1B6907E1C3E1373CB7F250C2BC66C44BB876961E9071F40205006A05189E51C2C14770C70C723F3FD --iscrypted

# Partition clearing information
clearpart --all --initlabel

# Disk partitioning information
part pv.01 --fstype=lvmpv --ondisk=vda --size=1024 --grow 
part /boot --fstype=xfs   --ondisk=vda --size=512   --fsoptions="nodev,nosuid,noexec"

# Create a Logical Volume Management group
volgroup rl --pesize=4096 pv.01

# Create particular logical volumes
logvol /              --fstype=xfs  --name=root          --vgname=rl --size=10240
logvol /home          --fstype=xfs  --name=home          --vgname=rl --size=2048    --fsoptions="nodev,nosuid,noexec"
logvol /tmp           --fstype=xfs  --name=tmp           --vgname=rl --size=10240   --fsoptions="nodev,nosuid,noexec"
logvol /var/tmp       --fstype=xfs  --name=var_tmp       --vgname=rl --size=10240   --fsoptions="nodev,nosuid"
logvol /var           --fstype=xfs  --name=var           --vgname=rl --size=10240   --fsoptions="nodev"
logvol /var/log       --fstype=xfs  --name=var_log       --vgname=rl --size=10240   --fsoptions="nodev,nosuid,noexec"
logvol /var/log/audit --fstype=xfs  --name=var_log_audit --vgname=rl --size=10240   --fsoptions="nodev,nosuid,noexec"
logvol swap           --fstype=swap --name=swap          --vgname=rl --size=2048 

# System timezone
timezone UTC --utc

# Root password
rootpw --iscrypted $6$y0ToQj4FDojgwNAj$ph7LNdS5jpKo5O6pe24c634SYSQbX4O47SHDNSieX85TIhP1Z2GzaxxIKtXSDh7pHDeepl2dR42BlAfRAMGzc/
user --groups=wheel --name=ansible --password=$6$/aYZMBGHTgCoYgqT$.shmItB2IV1aF0VeWSpOXZ/ysy0wv6nNu.SKUSoz.1v1OEQKhCWoaEyqhH.WU67Lj1lNR1bs9PWv8GX8aTzvp/ --iscrypted --gecos="ansible"
sshkey --username=ansible "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCXtiymbnftzKRgXXuIOSBdrCLVfxyTzhjhsk92uBRIvjhKHqyfHA3m9HKyFagU9Lym0JhMDRaVonIKV6DaXffC6Z51XgSOv1jAVypxDV5+FOb0jtuMMR3DMWkVx24NNgT0pSAS4INPgKmrWIkk9sisN8EeY0VeHqc+kEQybwz3hwEzuKlTgGD433lUQt8OZFQIiR0nMxiQwEDrXm8QCykfBwWQUno8MgWCMnZ4Kt8z4ZokVkJKovaTGLZSOX86h7ZTpQyracgk+9qmh9bpvty2UTwakYupjB/9vAZ1oD/4rBWetr80dllECJRU+SEHfywsl8wF8zF/B4+iCSRZKPjd root@mgnt"
